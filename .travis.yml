language: python

branches:
  except:
    - gh-pages

dist: trusty
sudo: required

matrix:
  exclude:
    - os: linux
    - os: osx

  include:
  - os: linux
    python: 3.6
    env: BUILD_TYPE=DOC
  - os: osx
    language: generic
    env: BUILD_TYPE=COVERAGE

before_install: source ./scripts/split_repo_slug.sh

install: ./scripts/deps.sh

script: ./scripts/build.sh

deploy:
  - provider: pypi
    skip_cleanup: true
    user: $PyPiUser
    password: $PyPiPsswd
    file: ./*.whl
    distributions: bdist_wheel
    on:
      tags: true
      branch: master
      repo: ${OWNER}/${REPO}
